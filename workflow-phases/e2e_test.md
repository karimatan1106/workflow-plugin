# E2E Test フェーズ

## subagent実行

このフェーズは**subagentとして実行**される。
**並列フェーズ (parallel_verification)** の一部として実行される。

---

## 目的

エンドツーエンド（E2E）テストを実行し、システム全体が正しく動作することを確認する。

## 入力

- タスクディレクトリ: `{workflowDir}`
- 仕様書: `docs/specs/domains/{domain}/{name}.md`
- テストケース: `test-cases.md`

## E2Eテスト項目

### 1. ユーザーシナリオテスト

- [ ] 主要なユーザーフローが正常に完了するか
- [ ] 複数ステップの操作が連続して成功するか
- [ ] セッション/認証が正しく維持されるか

### 2. 統合テスト

- [ ] フロントエンドとバックエンドの連携が正しいか
- [ ] API呼び出しが期待通りに動作するか
- [ ] データの永続化が正しく行われるか

### 3. クロスブラウザテスト（該当する場合）

- [ ] Chrome
- [ ] Firefox
- [ ] Safari
- [ ] Edge

### 4. エラーハンドリング

- [ ] ネットワークエラー時のリカバリー
- [ ] 無効な入力データの処理
- [ ] タイムアウト処理

## 実行手順

### 1. テスト環境の準備

```bash
# E2Eテストツールの例
# Playwright
pnpm exec playwright test

# Cypress
pnpm exec cypress run

# Jest + Puppeteer
pnpm test:e2e
```

### 2. テスト実行

1. テストスイートを実行
2. 失敗したテストを確認
3. スクリーンショット/動画を確認（該当する場合）

### 3. 結果の分析

- 失敗したテストの原因を特定
- フレーキーテスト（不安定なテスト）の有無を確認
- パフォーマンス問題の有無を確認

## log.md への記録

```markdown
### E2E_TEST（E2Eテスト）

- テストフレームワーク: [Playwright/Cypress/etc.]
- 実行環境: [環境情報]
- テスト結果:
  - 総テスト数: X件
  - 成功: X件
  - 失敗: 0件
  - スキップ: 0件
- 実行時間: Xm Xs
- 確認したシナリオ:
  - [シナリオ1]: OK
  - [シナリオ2]: OK
- 発見した問題:
  - なし / [問題の説明]
```

## 問題発見時の対応

### 軽微な問題

1. log.md に記録
2. Issue を作成して後日対応

### 重大な問題

1. log.md に記録
2. 実装フェーズに戻って修正
3. 再度E2Eテストを実行

## E2Eテストがない場合

プロジェクトにE2Eテストが設定されていない場合:

1. 手動でユーザーシナリオを実行
2. 結果を log.md に記録
3. E2Eテスト導入の推奨事項を記載

## 禁止事項

- テストをスキップする
- 失敗したテストを無視する
- 問題を記録せずに次に進む

## 完了条件

- [ ] E2Eテストを実行した（または手動シナリオテストを実施した）
- [ ] 全てのテストが成功した（または問題を記録した）
- [ ] log.md に結果を記録した
