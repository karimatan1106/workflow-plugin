# Commit フェーズ

## subagent実行

このフェーズは**subagentとして実行**される。

---

## 目的

変更をコミットし、プルリクエストを作成する。

## 入力

- タスクディレクトリ: `{workflowDir}`
- log.md: 変更履歴
- 全変更ファイル

## 実行手順

1. **変更内容の確認**

   ```bash
   git status
   git diff
   ```

2. **コミットメッセージの作成**
   - log.md から変更内容を抽出
   - Conventional Commits 形式

3. **コミット**

   ```bash
   git add .
   git commit -m "メッセージ"
   ```

4. **プルリクエスト作成（該当する場合）**
   ```bash
   gh pr create --title "タイトル" --body "説明"
   ```

## コミットメッセージ形式

### Conventional Commits

```
<type>(<scope>): <description>

[optional body]

[optional footer]
```

### Type

| Type     | 説明             |
| -------- | ---------------- |
| feat     | 新機能           |
| fix      | バグ修正         |
| docs     | ドキュメント     |
| style    | フォーマット     |
| refactor | リファクタリング |
| test     | テスト           |
| chore    | その他           |

### 例

```
feat(auth): ユーザー認証機能を追加

- ログイン/ログアウト機能
- セッション管理
- 権限チェック

Refs: #123
```

## コミット前チェックリスト

- [ ] 全テストがパスしている
- [ ] ビルドが成功している
- [ ] Lintエラーがない
- [ ] 不要なファイルがステージングされていない
- [ ] 機密情報（APIキー等）が含まれていない

## log.md への記録

```markdown
### COMMIT（コミット）

- コミットハッシュ: [hash]
- コミットメッセージ: [message]
- 変更ファイル数: X件
- 追加行数: +XXX
- 削除行数: -XXX
- PR: [URL]（作成した場合）
```

## プルリクエスト作成

### タイトル

```
[type]: 概要説明
```

### 説明テンプレート

```markdown
## 概要

[変更の概要]

## 変更内容

- [変更1]
- [変更2]

## テスト

- [ ] ユニットテスト
- [ ] 統合テスト
- [ ] 手動テスト

## 関連Issue

Closes #XXX
```

## 禁止事項

- テストが失敗している状態でコミット
- 機密情報をコミット
- 巨大なバイナリファイルをコミット

## 完了条件

- [ ] 変更をコミットした
- [ ] コミットメッセージが適切
- [ ] log.md に記録した
- [ ] PR を作成した（該当する場合）
