# Threat Modeling フェーズ

## subagent実行

このフェーズは**subagentとして実行**される。
**並列フェーズ (parallel_analysis)** の一部として実行される。

---

## 目的

セキュリティ脅威を分析し、対策を計画する（シフトレフト）。

## 入力

- タスクディレクトリ: `{workflowDir}`
- 要件: `requirements.md`
- 調査結果: `research.md`

## 実行手順

1. **STRIDE分析**
   - Spoofing（なりすまし）
   - Tampering（改ざん）
   - Repudiation（否認）
   - Information Disclosure（情報漏洩）
   - Denial of Service（サービス拒否）
   - Elevation of Privilege（権限昇格）

2. **脅威の特定**
   - 各コンポーネントの脅威を列挙
   - 攻撃シナリオを記述

3. **リスク評価**
   - 影響度と発生可能性を評価
   - 優先度を決定

4. **対策の計画**
   - 各脅威への対策を定義
   - 実装方針を決定

## 出力ファイル

### `{workflowDir}/threat-model.md`

```markdown
# 脅威モデル

## 対象システム

[システム概要]

## 脅威分析（STRIDE）

### Spoofing（なりすまし）

| ID    | 脅威       | 影響度   | 対策   |
| ----- | ---------- | -------- | ------ |
| T-001 | [脅威内容] | 高/中/低 | [対策] |

### Tampering（改ざん）

| ID    | 脅威       | 影響度   | 対策   |
| ----- | ---------- | -------- | ------ |
| T-002 | [脅威内容] | 高/中/低 | [対策] |

### Repudiation（否認）

| ID    | 脅威       | 影響度   | 対策   |
| ----- | ---------- | -------- | ------ |
| T-003 | [脅威内容] | 高/中/低 | [対策] |

### Information Disclosure（情報漏洩）

| ID    | 脅威       | 影響度   | 対策   |
| ----- | ---------- | -------- | ------ |
| T-004 | [脅威内容] | 高/中/低 | [対策] |

### Denial of Service（サービス拒否）

| ID    | 脅威       | 影響度   | 対策   |
| ----- | ---------- | -------- | ------ |
| T-005 | [脅威内容] | 高/中/低 | [対策] |

### Elevation of Privilege（権限昇格）

| ID    | 脅威       | 影響度   | 対策   |
| ----- | ---------- | -------- | ------ |
| T-006 | [脅威内容] | 高/中/低 | [対策] |

## 優先対応事項

1. [高優先度の脅威と対策]
2. ...

## セキュリティ要件

- [要件1]
- [要件2]
```

## 禁止事項

- コードの編集
- セキュリティ対策の実装（設計のみ）

## 完了条件

- [ ] STRIDE分析を完了した
- [ ] 全ての脅威を特定した
- [ ] リスク評価を行った
- [ ] 対策を計画した
- [ ] threat-model.md を作成した
